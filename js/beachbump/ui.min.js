(function(b){var a=BeachBump;var c=function(u){var k=scene("#beachball"),d=$("#hit-counter"),q=$("#beachball"),v=$("#message"),t=$(window),o=[],n=[],m=true;var j=null,s=10,e=0;function l(){if(j==null){j=setInterval(function(){v.text(e.toFixed(2));e+=1/(s*10)},s)}}function p(){e=0;clearInterval(j);j=null}function w(){var z=100,x=100,y=function(){var C=0,B=0;for(var A in o){C+=o[A]}for(var A in n){B+=n[A]}C/=o.length;B/=n.length;o=[];n=[];if(!isNaN(C)&&!isNaN(B)){k.vel(C*z,k.vel().y)}};return setInterval(y,x)}function h(){var z=$("#hit-icon"),y;for(var x=0;x<a.maxHits();x++){y=z.clone().attr("id","hit-icon-"+x);d.append(y)}}var r=function(){var z=null,y=0,A=6,D=1,x=u.maxCrabs;function C(){return 1000*(y+Math.random()*(A-y))}function B(){return setTimeout(function(){var E=D+Math.random()*(x-D);for(var F=0;F<E;F++){a.spawnCrab()}z=B()},C())}return{start:function(){if(z==null){z=B()}},stop:function(){clearInterval(z);z=null}}}();a.events.on("crab-attached",function(x){d.fadeIn()});a.events.on("crab-detached",function(x){d.fadeOut()});a.events.on("beachball-hit",function(y,x){d.fadeOut()});a.events.on("invulnerable",function(x){if(x){q.addClass("invulnerable")}else{q.removeClass("invulnerable")}});a.events.on("lost",function(){a.restart()});a.events.on("started",function(){d.fadeOut();l();r.start()});a.events.on("restarted",function(){d.fadeOut();r.stop();if(m){v.html('touch the screen or press the "S" key to start<h3>← and → move left and right; space jumps</h3>');m=false}else{v.html(e.toFixed(2)+"s<br/>final time");p()}});var f={};function i(x){_.each(x,function(z,y){y=parseInt(y);if(a.started()){switch(y){case 37:k.motion.enable("left");break;case 39:k.motion.enable("right");break;case 32:k.motion.enable("up");break}}})}function g(x){_.each(x,function(z,y){y=parseInt(y);if(a.started()){switch(y){case 37:k.motion.disable("left");break;case 39:k.motion.disable("right");break;case 67:a.spawnCrab();break}}if(y==83){a.start()}})}t.on("keydown",function(x){f[x.keyCode]=true;i(f)}).on("keyup",function(y){var x={};x[y.keyCode]=true;delete f[y.keyCode];g(x)});t.on("devicemotion",function(x){x=x.originalEvent;switch(window.orientation){case 90:o.push(-x.accelerationIncludingGravity.y);n.push(x.accelerationIncludingGravity.x);break;case -90:o.push(x.accelerationIncludingGravity.y);n.push(-x.accelerationIncludingGravity.x);break;default:o.push(x.accelerationIncludingGravity.x);n.push(x.accelerationIncludingGravity.y);break}});t.on("touchend",function(){if(!a.started()){a.start()}else{k.motion.enable("up")}});h();w();d.hide();d.children().addClass("flash");a.events.emit("loaded.ui")};a.events.on("loaded.core",c)})(this);
